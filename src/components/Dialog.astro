---
interface Props {
    id: string;
    title?: string;
    closeOutside?: boolean;
}

const { id, closeOutside, title } = Astro.props;
const shouldCloseOutside = closeOutside === false ? "" : id;
---

<div class="component-dialog">
    <input type="checkbox" id={id} hidden />
    <label for={shouldCloseOutside}></label>
    <main>
        <header><span>{title}</span><label for={id}>&times;</label></header>
        <div><slot /></div>
    </main>
</div>

<style lang="less">
    .component-dialog {
        & > input[type="checkbox"] {
            & + label {
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                opacity: 0;
                pointer-events: none;
                transition: opacity 0.2s;
                z-index: 999;
            }
            &:checked {
                & + label {
                    opacity: 1;
                    pointer-events: auto;
                }
                & ~ main {
                    opacity: 1;
                    pointer-events: auto;
                    transform: translateY(0);
                }
            }
            & ~ main {
                position: fixed;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -48%) scale(1);
                margin: 32px 0;
                opacity: 0;
                pointer-events: none;
                transition:
                    opacity 0.2s,
                    transform 0.2s;
                z-index: 1000;
                background: light-dark(var(--light-gray5), var(--dark-gray1));
                border-radius: 4px;
                display: flex;
                flex-direction: column;
                margin: 32px 0;
                pointer-events: all;
                user-select: text;
                box-shadow:
                    inset 0 0 0 1px
                        light-dark(
                            hsl(from var(--color-black) h s l / 0.1),
                            hsl(from var(--color-white) h s l / 0.2)
                        ),
                    0 2px 4px
                        light-dark(
                            hsl(from var(--color-black) h s l / 0.2),
                            hsl(from var(--color-black) h s l / 0.4)
                        ),
                    0 8px 24px
                        light-dark(
                            hsl(from var(--color-black) h s l / 0.2),
                            hsl(from var(--color-black) h s l / 0.4)
                        );

                & > header {
                    align-items: center;
                    background: light-dark(
                        var(--color-white),
                        var(--dark-gray3)
                    );
                    border-radius: 4px 4px 0 0;
                    box-shadow: inset 0 0 0 1px
                        light-dark(
                            hsl(from var(--color-black) h s l / 0.15),
                            hsl(from var(--color-white) h s l / 0.2)
                        );
                    display: flex;
                    flex: 0 0 auto;
                    min-height: 38px;
                    padding: 4px 4px 4px 16px;
                    z-index: 0;
                    & > span {
                        overflow: hidden;
                        text-overflow: ellipsis;
                        white-space: nowrap;
                        word-wrap: normal;
                        flex: 1 1 auto;
                        line-height: inherit;
                        margin: 0;
                    }
                    & > label {
                        padding: 4px 8px;
                        user-select: none;
                        cursor: pointer;
                        color: light-dark(
                            var(--dark-gray1),
                            var(--light-gray5)
                        );
                    }
                    & + div {
                        padding: 16px;
                    }
                }
            }
        }
    }
</style>

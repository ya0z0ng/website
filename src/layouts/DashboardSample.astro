---
import Layout from "./Layout.astro";
---

<Layout>
    <slot name="banner" />
    <div class="content">
        <nav><slot name="sidebar" /></nav>
        <main><slot /></main>
    </div>
</Layout>

<style lang="less">
    @sidebar-width: 255px;
    @max-content-width: 1080px;

    :root {
        --color-black: #111418;
        --color-white: #ffffff;
        --dark-gray1: #1c2127;
        --dark-gray2: #252a31;
        --dark-gray3: #2f343c;
        --dark-gray4: #383e47;
        --dark-gray5: #404854;
        --gray1: #5f6b7c;
        --gray2: #738091;
        --gray3: #8f99a8;
        --gray4: #abb3bf;
        --gray5: #c5cbd3;
        --light-gray1: #d3d8de;
        --light-gray2: #dce0e5;
        --light-gray3: #e5e8eb;
        --light-gray4: #edeff2;
        --light-gray5: #f6f7f9;
        --color-blue1: #184a90;
        --color-blue2: #215db0;
        --color-blue3: #2d72d2;
        --color-blue4: #4c90f0;
        --color-blue5: #8abbff;
        --color-green1: #165a36;
        --color-green2: #1c6e42;
        --color-green3: #238551;
        --color-green4: #32a467;
        --color-green5: #72ca9b;
        --color-orange1: #77450d;
        --color-orange2: #935610;
        --color-orange3: #c87619;
        --color-orange4: #ec9a3c;
        --color-orange5: #fbb360;
        --color-red1: #8e292c;
        --color-red2: #ac2f33;
        --color-red3: #cd4246;
        --color-red4: #e76a6e;
        --color-red5: #fa999c;

        --length-sidebar-width: @sidebar-width;
        --length-max-content-width: @max-content-width;
        --icon-close: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 20 20%27%3E%3Cpath fill=%27%23888%27 fill-rule=%27evenodd%27 d=%27M11.414 10l4.95-4.95a1 1 0 1 0-1.414-1.414L10 8.586 5.05 3.636a1 1 0 1 0-1.414 1.414L8.586 10l-4.95 4.95a1 1 0 1 0 1.414 1.414L10 11.414l4.95 4.95a1 1 0 0 0 1.414-1.414L11.414 10z%27 clip-rule=%27evenodd%27/%3E%3C/svg%3E");
    }

    @media (prefers-color-scheme: dark) {
        :root {
            color-scheme: dark;
        }
    }

    .scrollableY() {
        max-height: 100%;
        overflow-y: auto;
    }

    body {
        // (sidebar + (width - max) / 2) / width
        --rate-body-background: max(
            var(--length-sidebar-width),
            calc(
                50% + var(--length-sidebar-width) -
                    var(--length-max-content-width) / 2
            )
        );
        position: fixed;
        overflow: hidden;
        width: 100dvw;

        background: linear-gradient(
            90deg,
            light-dark(white, var(--dark-gray3)) var(--rate-body-background),
            light-dark(
                    hsl(from var(--color-black) h s l / 0.15),
                    hsl(from var(--color-black) h s l / 0.4)
                )
                var(--rate-body-background)
                calc(var(--rate-body-background) + 1px),
            light-dark(var(--light-gray5), var(--dark-gray1))
                calc(var(--rate-body-background) + 1px)
        );
        background-attachment: fixed;
    }

    .content {
        display: grid;
        grid-template-columns: var(--length-sidebar-width) 1fr;
        grid-template-rows: auto 1fr;
        height: 100dvh;
        max-width: var(--length-max-content-width);
        margin: 0 auto;

        & > :global(*):not(nav):not(main) {
            grid-column: 1 / 3;
            grid-row: 1 / 2;
        }

        & > nav {
            grid-column: 1 / 2;
            grid-row: 2 / 3;
            .scrollableY();
        }

        & > main {
            grid-column: 2 / 3;
            grid-row: 2 / 3;
            padding-left: 1px;
            .scrollableY();
        }
    }

    /// define button styles
    :global(button) {
        .buttonShadowIntentFromColor() {
            --color-btn-shadow-from: light-dark(
                hsl(from var(--color-black) h s l / 0.2),
                hsl(from var(--color-white) h s l / 0.1)
            );
        }
        .buttonShadowIntentFromColorActive() {
            --color-btn-shadow-from: light-dark(
                hsl(from var(--color-black) h s l / 0.2),
                hsl(from var(--color-white) h s l / 0.1)
            );
            --btn-shadow: light-dark(
                hsl(from var(--color-black) h s l / 0.2),
                hsl(from var(--color-black) h s l / 0.4)
            );
        }

        --btn-shadow: light-dark(
            hsl(from var(--color-black) h s l / 0.1),
            hsl(from var(--color-black) h s l / 0.2)
        );

        align-items: center;
        border: none;
        border-radius: 2px;
        cursor: pointer;
        display: inline-flex;
        flex-direction: row;
        font-size: 14px;
        justify-content: center;
        min-height: 30px;
        min-width: 30px;
        padding: 4px 10px;
        text-align: left;
        vertical-align: middle;
        color: var(--color-btn-text);
        &:not(.style-minimal) {
            background-color: var(--color-btn-bg);
        }
        &:not(.style-minimal):not(.style-outlined) {
            box-shadow:
                inset 0 0 0 1px var(--color-btn-shadow-from),
                0 1px 2px var(--btn-shadow);
        }

        &:not([class*="intent-"]) {
            --color-btn-bg: light-dark(var(--light-gray5), var(--dark-gray3));
            --color-btn-text: light-dark(var(--dark-gray1), var(--light-gray5));
            --color-btn-shadow-from: light-dark(
                hsl(from var(--color-black) h s l / 0.1),
                hsl(from var(--color-white) h s l / 0.2)
            );
            &:not(.style-minimal) {
                &:hover {
                    --color-btn-bg: light-dark(
                        var(--light-gray4),
                        var(--dark-gray2)
                    );
                    .buttonShadowIntentFromColorActive();
                }
                &:active {
                    --color-btn-bg: light-dark(
                        var(--light-gray2),
                        var(--dark-gray1)
                    );
                    .buttonShadowIntentFromColorActive();
                }
            }
            &.style-minimal {
                &:hover {
                    background-color: hsl(from var(--gray3) h s l / 0.15);
                }
                &:active {
                    background-color: hsl(from var(--gray3) h s l / 0.3);
                }
            }
        }

        &.intent-primary {
            --color-btn-bg: var(--color-blue3);
            .buttonShadowIntentFromColor();
            &:not(.style-minimal) {
                --color-btn-text: var(--color-white);
                &:hover {
                    --color-btn-bg: var(--color-blue2);
                }
                &:active {
                    --color-btn-bg: var(--color-blue1);
                    .buttonShadowIntentFromColorActive();
                }
            }
            &.style-minimal {
                --color-btn-text: light-dark(
                    var(--color-blue2),
                    var(--color-blue5)
                );
                &:hover {
                    background-color: hsl(from var(--color-blue3) h s l / 0.2);
                }
                &:active {
                    --color-btn-text: light-dark(
                        var(--color-blue1),
                        var(--color-blue5)
                    );
                    background-color: hsl(from var(--color-blue3) h s l / 0.3);
                }
            }
        }

        &.intent-success {
            --color-btn-bg: var(--color-green3);
            .buttonShadowIntentFromColor();
            &:not(.style-minimal) {
                --color-btn-text: var(--color-white);
                &:hover {
                    --color-btn-bg: var(--color-green2);
                }
                &:active {
                    --color-btn-bg: var(--color-green1);
                    .buttonShadowIntentFromColorActive();
                }
            }
            &.style-minimal {
                --color-btn-text: light-dark(
                    var(--color-green2),
                    var(--color-green5)
                );
                &:hover {
                    background-color: hsl(from var(--color-green3) h s l / 0.2);
                }
                &:active {
                    --color-btn-text: light-dark(
                        var(--color-green1),
                        var(--color-green5)
                    );
                    background-color: hsl(from var(--color-green3) h s l / 0.3);
                }
            }
        }

        &.intent-warning {
            --color-btn-bg: var(--color-orange5);
            .buttonShadowIntentFromColor();
            &:not(.style-minimal) {
                --color-btn-text: var(--color-black);
                &:hover {
                    --color-btn-bg: var(--color-orange4);
                }
                &:active {
                    --color-btn-bg: var(--color-orange3);
                    .buttonShadowIntentFromColorActive();
                }
            }
            &.style-minimal {
                --color-btn-text: light-dark(
                    var(--color-orange2),
                    var(--color-orange5)
                );
                &:hover {
                    background-color: hsl(
                        from var(--color-orange3) h s l / 0.2
                    );
                }
                &:active {
                    --color-btn-text: light-dark(
                        var(--color-orange1),
                        var(--color-orange5)
                    );
                    background-color: hsl(
                        from var(--color-orange3) h s l / 0.3
                    );
                }
            }
        }

        &.intent-danger {
            --color-btn-bg: var(--color-red3);
            .buttonShadowIntentFromColor();
            &:not(.style-minimal) {
                --color-btn-text: var(--color-white);
                &:hover {
                    --color-btn-bg: var(--color-red2);
                }
                &:active {
                    --color-btn-bg: var(--color-red1);
                    .buttonShadowIntentFromColorActive();
                }
            }
            &.style-minimal {
                --color-btn-text: light-dark(
                    var(--color-red2),
                    var(--color-red5)
                );
                &:hover {
                    background-color: hsl(from var(--color-red3) h s l / 0.2);
                }

                &:active {
                    --color-btn-text: light-dark(
                        var(--color-red1),
                        var(--color-red5)
                    );
                    background-color: hsl(from var(--color-red3) h s l / 0.3);
                }
            }
        }
    }

    /// define tag styles
    :global(span.dbs-tag) {
        --color-dbs-tag-text: var(--color-white);
        --color-dbs-tag-bg: var(--gray1);
        align-items: center;
        background-color: var(--color-dbs-tag-bg);
        border: none;
        box-shadow: none;
        color: var(--color-dbs-tag-text);
        display: inline-flex;
        flex-direction: row;
        font-size: 12px;
        line-height: 16px;
        max-width: 100%;
        min-height: 20px;
        min-width: 20px;
        position: relative;

        &:not(.style-rounded) {
            border-radius: 2px;
            padding: 2px 6px;
        }
        &.style-rounded {
            border-radius: 30px;
            padding-left: 8px;
            padding-right: 8px;
        }

        &.intent-primary {
            &:not(.style-minimal) {
                --color-dbs-tag-bg: var(--color-blue3);
            }
            &.style-minimal {
                --color-dbs-tag-bg: light-dark(
                    hsl(from var(--color-blue3) h s l / 0.1),
                    hsl(from var(--color-blue3) h s l / 0.2)
                );
                --color-dbs-tag-text: light-dark(
                    var(--color-blue2),
                    var(--color-blue5)
                );
            }
        }
        &.intent-success {
            --color-dbs-tag-bg: var(--color-green3);
            &.style-minimal {
                --color-dbs-tag-bg: light-dark(
                    hsl(from var(--color-green3) h s l / 0.1),
                    hsl(from var(--color-green3) h s l / 0.2)
                );
                --color-dbs-tag-text: light-dark(
                    var(--color-green2),
                    var(--color-green5)
                );
            }
        }
        &.intent-warning {
            --color-dbs-tag-bg: var(--color-orange5);
            --color-dbs-tag-text: var(--color-black);
            &.style-minimal {
                --color-dbs-tag-bg: light-dark(
                    hsl(from var(--color-orange3) h s l / 0.1),
                    hsl(from var(--color-orange3) h s l / 0.2)
                );
                --color-dbs-tag-text: light-dark(
                    var(--color-orange2),
                    var(--color-orange5)
                );
            }
        }
        &.intent-danger {
            --color-dbs-tag-bg: var(--color-red3);
            &.style-minimal {
                --color-dbs-tag-bg: light-dark(
                    hsl(from var(--color-red3) h s l / 0.1),
                    hsl(from var(--color-red3) h s l / 0.2)
                );
                --color-dbs-tag-text: light-dark(
                    var(--color-red2),
                    var(--color-red5)
                );
            }
        }
    }

    :global(span.dbs-progress-bar) {
        --color-dbs-progress-bar-bg: hsl(from var(--gray1) h s l / 0.8);
        background: hsl(from var(--gray1) h s l / 0.2);
        border-radius: 40px;
        display: block;
        height: 8px;
        overflow: hidden;
        position: relative;
        max-width: 100%;

        &::after {
            content: "";
            animation: linear-progress-bar-stripes 0.3s linear infinite reverse;
            background: linear-gradient(
                -45deg,
                hsla(0, 0%, 100%, 0.2) 25%,
                transparent 0,
                transparent 50%,
                hsla(0, 0%, 100%, 0.2) 0,
                hsla(0, 0%, 100%, 0.2) 75%,
                transparent 0
            );
            background-color: var(--color-dbs-progress-bar-bg);
            background-size: 30px 30px;
            border-radius: 40px;
            height: 100%;
            position: absolute;
            transition: width 0.2s cubic-bezier(0.4, 1, 0.75, 0.9);
            width: 100%;
        }

        @keyframes linear-progress-bar-stripes {
            0% {
                background-position: 0 0;
            }

            to {
                background-position: 30px 0;
            }
        }

        &.intent-primary::after {
            --color-dbs-progress-bar-bg: var(--color-blue3);
        }

        &.intent-success::after {
            --color-dbs-progress-bar-bg: var(--color-green3);
        }

        &.intent-warning::after {
            --color-dbs-progress-bar-bg: var(--color-orange3);
        }

        &.intent-danger::after {
            --color-dbs-progress-bar-bg: var(--color-red3);
        }
    }
</style>
